!function(e){var o,s,t,i,n=1,a=this,r=a.postMessage&&!/opera/.test(navigator.userAgent.toLowerCase());e.postMessage=function(o,s,t){s&&(o="string"==typeof o?o:e.param(o),t=t||parent,r?t.postMessage(o,s.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):s&&(t.location=s.replace(/#.*$/,"")+"#"+ +new Date+n++ +"&"+o))},e.receiveMessage=i=function(n,d,c){r?(n&&(t&&i(),t=function(o){return!("string"==typeof d&&o.origin!==d||e.isFunction(d)&&!1===d(o.origin))&&void n(o)}),a.addEventListener?a[n?"addEventListener":"removeEventListener"]("message",t,!1):a[n?"attachEvent":"detachEvent"]("onmessage",t)):(o&&clearInterval(o),o=null,n&&(o=setInterval(function(){var e=document.location.hash,o=/^#?\d+&/;e!==s&&o.test(e)&&(s=e,n({data:e.replace(o,"")}))},"number"==typeof d?d:"number"==typeof c?c:100)))}}(jQuery),function(e){e.getUrlParam=function(e){var o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),s=window.location.search.substr(1).match(o);return null!=s?unescape(s[2]):null}}(jQuery),function(e){var o=e("#sso_script"),s=o.attr("data-ssoSite"),t=o.attr("data-ssoReferer"),i=o.attr("data-ssoScene"),n=o.attr("data-ssoSiteid");t=t?t:encodeURIComponent(location.href),i=void 0!=i?i:"";var a=e.getUrlParam("tid");a=a?a:"";var r=s+"/login?referer="+t+"&siteid="+n+"&scene="+i+"&account="+(e.getUrlParam("account")||"")+"#"+encodeURIComponent(location.href),d=s+"/register?tid="+a+"&referer="+t+"&siteid="+n+"&scene="+i+"&account="+(e.getUrlParam("account")||"")+"#"+encodeURIComponent(location.href),c=s+"/password/changepwd?siteid="+n+"#"+encodeURIComponent(location.href);if(e.getUrlParam("special")&&(d=s+"/register?tid="+a+"&referer="+e.getUrlParam("referer")+"&special="+e.getUrlParam("special")+"&siteid="+n+"&scene="+i+"#"+encodeURIComponent(location.href)),0==e("iframe[name^='sso-']").length){var l=s+"/public/pc/css/sso.dialogPassport.css?20210311";e("head").append('<link rel="stylesheet" href="'+l+'"/>')}e.extend({ssoDialogLogin:function(o){var t=e('<div class="sso_layer"></div><div class="sso_dialog"><div class="sso_dialog_header"><span class="sso_dialog_title">登录</span><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe sandbox="allow-same-origin allow-scripts allow-top-navigation allow-forms" frameborder="0" scrolling="no" onload=""></iframe></div></div>');t.appendTo("body").find("iframe").attr("src",r),t.on("click",".sso_dialog_close",function(){t.remove()}),e.receiveMessage(function(s){var i=t.find("iframe");if(e.isNumeric(s.data)){i.css("height",s.data+"px");var n=t.find(".sso_dialog_header").height(),a=t.find(".sso_dialog_content").outerHeight(),d=n+a;e(".sso_dialog").css({height:d+"px","margin-top":0-d/2+"px"})}else"reload"==s.data?window.location.reload():"string"==typeof s.data&&~s.data.search(/^https?/)&&e.ajax({type:"get",url:decodeURIComponent(s.data),success:function(t,n,a){function d(){if(!d.called){if(d.called=!0,"string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(s);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():(e.postMessage(t,r,i.get(0).contentWindow),void setTimeout(function(){location.reload()},3e3))}}if("success"===t){var c=a.getResponseHeader("union_id");c&&window.sensors&&sensors.login(c),"sensors"in window?sensors.track("login",{title:document.title,url:location.href},d):d(),setTimeout(d,3e3)}}})},s)},ssoDialogRegist:function(o){var i=e('<div class="sso_layer"></div><div class="sso_dialog"><div class="sso_dialog_header"><span class="sso_dialog_title">注册</span><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe sandbox="allow-same-origin allow-scripts allow-top-navigation allow-forms" frameborder="0" scrolling="no" onload=""></iframe></div></div>');i.appendTo("body").find("iframe").attr("src",d),i.on("click",".sso_dialog_close",function(){i.remove()}),"sensors"in window&&sensors.track("eClickRegister",{current_url:location.href,current_title:document.title,site_domain:document.domain}),e.receiveMessage(function(s){var n=(new Date).valueOf(),a=i.find("iframe");if(e.isNumeric(s.data)){a.css("height",s.data+"px");var d=i.find(".sso_dialog_header").height(),c=i.find(".sso_dialog_content").outerHeight(),l=d+c;i.find(".sso_dialog").css({height:l+"px","margin-top":0-l/2+"px"})}else"string"==typeof s.data&&~s.data.search(/^https?/)&&e.ajax({type:"get",url:decodeURIComponent(s.data),success:function(i,d,c){function l(){if(!l.called){if(l.called=!0,"string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(s);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():""==t?void window.location.reload():(e.postMessage(i,r,a.get(0).contentWindow),void setTimeout(function(){location.reload()},3e3))}}if("success"===i){var f=c.getResponseHeader("union_id");if(f&&window.sensors&&sensors.login(f),"sensors"in window){var g=(new Date).valueOf();sensors.track("signUp",{event_duration:(g-n)/60,register_source:location.href},l)}else l();setTimeout(l,3e3)}}})},s)},ssoPageLogin:function(){var o=e("iframe[name='sso-LoginIframe']");o.attr("src",r),e.receiveMessage(function(s){e.isNumeric(s.data)?o.css("height",s.data+"px"):"string"==typeof s.data&&~s.data.search(/^https?/)&&e.ajax({type:"get",url:decodeURIComponent(s.data),success:function(s,i,n){function a(){a.called||(a.called=!0,""==t?window.location.href="/":(e.postMessage(s,r,o.get(0).contentWindow),setTimeout(function(){location.reload()},3e3)))}if("success"===s){var d=n.getResponseHeader("union_id");d&&window.sensors&&sensors.login(d),"sensors"in window?sensors.track("login",{title:document.title,url:location.href},a):a(),setTimeout(a,3e3)}}})},s)},ssoPageRegist:function(){var o=(new Date).valueOf(),i=e("iframe[name='sso-RegistIframe']");i.attr("src",d),"sensors"in window&&sensors.track("eClickRegister",{current_url:e.getUrlParam("referer")||document.referrer,current_title:document.title,site_domain:document.domain}),e.receiveMessage(function(s){e.isNumeric(s.data)?i.css("height",s.data+"px"):"string"==typeof s.data&&~s.data.search(/^https?/)&&e.ajax({type:"get",url:decodeURIComponent(s.data),success:function(s,n,a){function r(){r.called||(r.called=!0,""==t?window.location.href="/":(e.postMessage(s,d,i.get(0).contentWindow),setTimeout(function(){location.reload()},3e3)))}if("success"===s){var c=a.getResponseHeader("union_id");if(c&&window.sensors&&sensors.login(c),"sensors"in window){var l=(new Date).valueOf();sensors.track("signUp",{event_duration:(l-o)/60,register_source:location.href},r)}else r();setTimeout(r,3e3)}}})},s)},ssoPageChangepwd:function(){var o=e("iframe[name='sso-ChangepwdIframe']");o.attr("src",c),e.receiveMessage(function(s){e.isNumeric(s.data)?o.css("height",s.data+"px"):"string"==typeof s.data&&e.postMessage("success",c,o.get(0).contentWindow)},s)},scrollLogin:function(o){var r=s+"/register?tid="+a+"&special=wwwquick&referer="+t+"&siteid="+n+"&scene="+i+"#"+encodeURIComponent(location.href),d=r,c=e("#ssoScrollLog");c.append('<iframe sandbox="allow-same-origin allow-scripts allow-top-navigation allow-forms"></iframe>'),c.find("iframe").attr("src",d),e.receiveMessage(function(s){var t=c.find("iframe");if(e.isNumeric(s.data)){t.css("height",s.data+"px");c.find(".sso_dialog_header").height(),c.find(".sso_dialog_content").outerHeight();e("#ssoScrollLog iframe").css({height:"350px","margin-top":"45px"})}else"reload"==s.data?window.location.reload():"string"==typeof s.data&&~s.data.search(/^https?/)&&e.ajax({type:"get",url:decodeURIComponent(s.data),success:function(i,n,a){function r(){if(!r.called){if(r.called=!0,"string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(s);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():(e.postMessage(i,d,t.get(0).contentWindow),void setTimeout(function(){location.reload()},3e3))}}if("success"===i){var c=a.getResponseHeader("union_id");c&&window.sensors&&sensors.login(c),"sensors"in window?sensors.track("login",{title:document.title,url:location.href},r):r(),setTimeout(r,3e3)}}})},s)},bbsActivityLogin:function(o){var i=s+"/login?special=activity&referer="+t+"&siteid="+n+"#"+encodeURIComponent(location.href),a=e('<div class="sso_layer"></div><div class="sso_dialog" id="activity_login"><div class="sso_dialog_header"><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe sandbox="allow-same-origin allow-scripts allow-top-navigation allow-forms" frameborder="0" scrolling="no" ></iframe></div></div>');a.appendTo("body").find("iframe").attr("src",i),a.on("click",".sso_dialog_close",function(){a.remove()}),e.receiveMessage(function(s){var t=a.find("iframe");if(e.isNumeric(s.data)){t.css("height",s.data+"px");var n=a.find(".sso_dialog_header").height(),r=a.find(".sso_dialog_content").outerHeight(),d=n+r;e(".sso_dialog").css({height:d+"px","margin-top":0-d/2+"px"})}else"reload"==s.data?window.location.reload():"string"==typeof s.data&&~s.data.search(/^https?/)&&e.ajax({type:"get",url:decodeURIComponent(s.data),success:function(n,a,r){function d(){if(!d.called){if(d.called=!0,"string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(s);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():(e.postMessage(n,i,t.get(0).contentWindow),void setTimeout(function(){location.reload()},3e3))}}if("success"===n){var c=r.getResponseHeader("union_id");c&&window.sensors&&sensors.login(c),"sensors"in window?sensors.track("login",{title:document.title,url:location.href},d):d(),setTimeout(d,3e3)}}})},s)}}),0!=e("iframe[name='sso-LoginIframe']").length?e.ssoPageLogin():0!=e("iframe[name='sso-RegistIframe']").length?e.ssoPageRegist():0!=e("iframe[name='sso-ChangepwdIframe']").length&&e.ssoPageChangepwd()}(jQuery);